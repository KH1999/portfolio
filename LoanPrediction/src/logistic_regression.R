rm(list=ls())

#####################################################################################################################
## In this file we use a logistic regrassion model to predict default
#####################################################################################################################

#####################################################################################################################
## install and load packages
#####################################################################################################################
#install.packages("pROC")
#install.packages("ggplot2")

library(pROC)
library(ggplot2)

#####################################################################################################################
## load the data
#####################################################################################################################
#load data
#reading in data
train <- read.csv(file = "./data/gold/train.csv")
validation <- read.csv(file = "./data/gold/validation.csv")
test <-read.csv(file = "./data/gold/test.csv")
all <- read.csv(file = "./data/gold/all.csv")

#####################################################################################################################
## fitting the model
#####################################################################################################################
logmodel <- glm(default ~ ., family = binomial, data = train) 

#####################################################################################################################
##using the model to predict validation set
#####################################################################################################################
logmodel_prob <- predict(logmodel, type = "response", newdata = validation)

#####################################################################################################################
## evaluate model on validation set
#####################################################################################################################
roc_obj <- roc(validation$default, logmodel_prob)
auc(roc_obj)
plot_roc_obj <- plot(roc_obj)

#####################################################################################################################
## train model on all the training data and predict the test data
#####################################################################################################################
logmodel_all <- glm(default ~ ., family = binomial, data = all) 

logmodel_prob_test <- predict(logmodel_all, type = "response", newdata = test_no_id)

#####################################################################################################################
## write the predictions of the test data
#####################################################################################################################
id <- test$id
default <- logmodel_prob_test

Kaggle <- data.frame(id,default)

write.csv(Kaggle,"./data/result/Kaggle_logreg_16.csv", row.names = FALSE)







